\documentclass[a4paper]{article}

\usepackage{etoolbox}
\usepackage[nounderscore]{syntax}
\usepackage{amsmath,amssymb}
\usepackage[svgnames]{xcolor}
\usepackage{algorithmicx}
\usepackage{algpseudocode}
\usepackage{fullpage}
\usepackage{listings}
\usepackage{tikz}
\usetikzlibrary{arrows}
\usepackage{hyperref}

\hypersetup{colorlinks=true,linkcolor=DarkRed}

\newcommand{\TODO}[1]{{\color{red}{TODO: #1}}}

\lstset{
  basicstyle=\ttfamily\small,
  columns=fullflexible,
  breaklines=true,
  postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space},
}

\lstdefinelanguage{sail}
  { morekeywords={val,function,mapping,cast,type,forall,overload,operator,enum,union,undefined,exit,and,assert,sizeof,
      scattered,register,inc,dec,if,then,else,effect,let,as,@,in,end,Type,Int,Order,match,clause,struct,
      foreach,from,to,by,infix,infixl,infixr,bitfield,default,try,catch,throw,constraint,monadic},
    keywordstyle={\bf\ttfamily\color{blue}},
    morestring=[b]",
    stringstyle={\ttfamily\color{red}},
    morecomment=[l][\itshape\color{DarkGreen}]{//},
    morecomment=[s][\itshape\color{DarkGreen}]{/*}{*/},
    deletestring=[bd]{'},
    escapechar=\#,
    emphstyle={\it},
    literate=
      {\{|}{{$\{|$}}1
      {|\}}{{$|\}$}}1
  }

\lstset{language=sail}

\begin{document}

\tableofcontents

\title{The gameboy instruction set}

\section{Instruction set}

\include{instructions/commands.tex}
\subsection{ADCAN}
\sailfclADCANimmdecodeOneSix
\sailfclADCANassembly
\sailfclADCANexecute
\subsection{ADCAR}
\sailfclADCARrdecode
\sailfclADCARassembly
\sailfclADCARexecute
\subsection{ADDAN}
\sailfclADDANimmdecodeOneSix
\sailfclADDANassembly
\sailfclADDANexecute
\subsection{ADDAR}
\sailfclADDARrdecode
\sailfclADDARassembly
\sailfclADDARexecute
\subsection{ADDHLRR}
\sailfclADDHLRRrrdecode
\sailfclADDHLRRassembly
\sailfclADDHLRRexecute
\subsection{ADDSPD}
\sailfclADDSPDddecodeOneSix
\sailfclADDSPDassembly
\sailfclADDSPDexecute
\subsection{ANDN}
\sailfclANDNimmdecodeOneSix
\sailfclANDNassembly
\sailfclANDNexecute
\subsection{ANDR}
\sailfclANDRrdecode
\sailfclANDRassembly
\sailfclANDRexecute
\subsection{BITNR}
\sailfclBITNRdecodeOneSix
\sailfclBITNRassembly
\sailfclBITNRexecute
\subsection{CALLFNN}
\sailfclCALLFNNdecodeTwoFour
\sailfclCALLFNNassembly
\sailfclCALLFNNexecute
\subsection{CALLNN}
\sailfclCALLNNmakeLsbimmdecodeTwoFour
\sailfclCALLNNassembly
\sailfclCALLNNexecute
\subsection{CCF}
\sailfclCCFdecode
\sailfclCCFassembly
\sailfclCCFexecute
\subsection{CPL}
\sailfclCPLdecode
\sailfclCPLassembly
\sailfclCPLexecute
\subsection{CPN}
\sailfclCPNimmdecodeOneSix
\sailfclCPNassembly
\sailfclCPNexecute
\subsection{CPR}
\sailfclCPRrdecode
\sailfclCPRassembly
\sailfclCPRexecute
\subsection{DAA}
\sailfclDAAdecode
\sailfclDAAassembly
\sailfclDAAexecute
\subsection{DECR}
\sailfclDECRrdecode
\sailfclDECRRrrdecode
\sailfclDECRassembly
\sailfclDECRRassembly
\sailfclDECRexecute
\sailfclDECRRexecute
\subsection{DECRR}
\sailfclDECRRrrdecode
\sailfclDECRRassembly
\sailfclDECRRexecute
\subsection{DI}
\sailfclDIdecode
\sailfclDIassembly
\sailfclDIexecute
\subsection{EI}
\sailfclEIdecode
\sailfclEIassembly
\sailfclEIexecute
\subsection{HALT}
\sailfclHALTdecode
\sailfclHALTassembly
\sailfclHALTexecute
\subsection{INCR}
\sailfclINCRrdecode
\sailfclINCRRrrdecode
\sailfclINCRassembly
\sailfclINCRRassembly
\sailfclINCRexecute
\sailfclINCRRexecute
\subsection{INCRR}
\sailfclINCRRrrdecode
\sailfclINCRRassembly
\sailfclINCRRexecute
\subsection{INVALID}
\sailfclINVALIDnotSupporteddecodeTwoFour
\sailfclINVALIDassembly
\sailfclINVALIDexecute
\subsection{JPCNN}
\sailfclJPCNNdecodeTwoFour
\sailfclJPCNNassembly
\sailfclJPCNNexecute
\subsection{JPFNN}
\sailfclJPFNNdecodeTwoFour
\sailfclJPFNNassembly
\sailfclJPFNNexecute
\subsection{JPHL}
\sailfclJPHLdecode
\sailfclJPHLassembly
\sailfclJPHLexecute
\subsection{JPNN}
\sailfclJPNNmakeLsbimmdecodeTwoFour
\sailfclJPNNassembly
\sailfclJPNNexecute
\subsection{JRCN}
\sailfclJRCNdecodeOneSix
\sailfclJRCNassembly
\sailfclJRCNexecute
\subsection{JRNN}
\sailfclJRNNimmdecodeOneSix
\sailfclJRNNassembly
\sailfclJRNNexecute
\subsection{LDABC}
\sailfclLDABCdecode
\sailfclLDABCassembly
\sailfclLDABCexecute
\subsection{LDADE}
\sailfclLDADEdecode
\sailfclLDADEassembly
\sailfclLDADEexecute
\subsection{LDAFF00C}
\sailfclLDAFFZeroZeroCdecode
\sailfclLDAFFZeroZeroCassembly
\sailfclLDAFFZeroZeroCexecute
\subsection{LDAFF00NN}
\sailfclLDAFFZeroZeroNNimmdecodeOneSix
\sailfclLDAFFZeroZeroNNassembly
\sailfclLDAFFZeroZeroNNexecute
\subsection{LDANN}
\sailfclLDANNmakeLsbimmdecodeTwoFour
\sailfclLDANNassembly
\sailfclLDANNexecute
\subsection{LDBCA}
\sailfclLDBCAdecode
\sailfclLDBCAassembly
\sailfclLDBCAexecute
\subsection{LDDAHL}
\sailfclLDDAHLdecode
\sailfclLDDAHLassembly
\sailfclLDDAHLexecute
\subsection{LDDEA}
\sailfclLDDEAdecode
\sailfclLDDEAassembly
\sailfclLDDEAexecute
\subsection{LDDHLA}
\sailfclLDDHLAdecode
\sailfclLDDHLAassembly
\sailfclLDDHLAexecute
\subsection{LDFF00CA}
\sailfclLDFFZeroZeroCAdecode
\sailfclLDFFZeroZeroCAassembly
\sailfclLDFFZeroZeroCAexecute
\subsection{LDFF00NNA}
\sailfclLDFFZeroZeroNNAimmdecodeOneSix
\sailfclLDFFZeroZeroNNAassembly
\sailfclLDFFZeroZeroNNAexecute
\subsection{LDHLSPDD}
\sailfclLDHLSPDDddecodeOneSix
\sailfclLDHLSPDDassembly
\sailfclLDHLSPDDexecute
\subsection{LDIAHL}
\sailfclLDIAHLdecode
\sailfclLDIAHLassembly
\sailfclLDIAHLexecute
\subsection{LDIHLA}
\sailfclLDIHLAdecode
\sailfclLDIHLAassembly
\sailfclLDIHLAexecute
\subsection{LDNNA}
\sailfclLDNNAmakeLsbimmdecodeTwoFour
\sailfclLDNNAassembly
\sailfclLDNNAexecute
\subsection{LDNNSP}
\sailfclLDNNSPmakeLsbimmdecodeTwoFour
\sailfclLDNNSPassembly
\sailfclLDNNSPexecute
\subsection{LDRN}
\sailfclLDRNdecodeOneSix
\sailfclLDRNassembly
\sailfclLDRNexecute
\subsection{LDRR}
\sailfclLDRRdecode
\sailfclLDRRNNdecodeTwoFour
\sailfclLDRRassembly
\sailfclLDRRNNassembly
\sailfclLDRRexecute
\sailfclLDRRNNexecute
\subsection{LDRRNN}
\sailfclLDRRNNdecodeTwoFour
\sailfclLDRRNNassembly
\sailfclLDRRNNexecute
\subsection{LDSPHL}
\sailfclLDSPHLdecode
\sailfclLDSPHLassembly
\sailfclLDSPHLexecute
\subsection{NOP}
\sailfclNOPdecode
\sailfclNOPassembly
\sailfclNOPexecute
\subsection{ORN}
\sailfclORNimmdecodeOneSix
\sailfclORNassembly
\sailfclORNexecute
\subsection{ORR}
\sailfclORRrdecode
\sailfclORRassembly
\sailfclORRexecute
\subsection{POPRR}
\sailfclPOPRRrrdecode
\sailfclPOPRRassembly
\sailfclPOPRRexecute
\subsection{PUSHRR}
\sailfclPUSHRRrrdecode
\sailfclPUSHRRassembly
\sailfclPUSHRRexecute
\subsection{RESNR}
\sailfclRESNRdecodeOneSix
\sailfclRESNRassembly
\sailfclRESNRexecute
\subsection{RET}
\sailfclRETdecode
\sailfclRETFcdecode
\sailfclRETIdecode
\sailfclRETassembly
\sailfclRETFassembly
\sailfclRETIassembly
\sailfclRETexecute
\sailfclRETFexecute
\sailfclRETIexecute
\subsection{RETF}
\sailfclRETFcdecode
\sailfclRETFassembly
\sailfclRETFexecute
\subsection{RETI}
\sailfclRETIdecode
\sailfclRETIassembly
\sailfclRETIexecute
\subsection{RLA}
\sailfclRLAdecode
\sailfclRLAassembly
\sailfclRLAexecute
\subsection{RLCA}
\sailfclRLCAdecode
\sailfclRLCAassembly
\sailfclRLCAexecute
\subsection{RLCR}
\sailfclRLCRrdecodeOneSix
\sailfclRLCRassembly
\sailfclRLCRexecute
\subsection{RLR}
\sailfclRLRrdecodeOneSix
\sailfclRLRassembly
\sailfclRLRexecute
\subsection{RRA}
\sailfclRRAdecode
\sailfclRRAassembly
\sailfclRRAexecute
\subsection{RRCA}
\sailfclRRCAdecode
\sailfclRRCAassembly
\sailfclRRCAexecute
\subsection{RRCR}
\sailfclRRCRrdecodeOneSix
\sailfclRRCRassembly
\sailfclRRCRexecute
\subsection{RRR}
\sailfclRRRrdecodeOneSix
\sailfclRRRassembly
\sailfclRRRexecute
\subsection{RSTN}
\sailfclRSTNrdecode
\sailfclRSTNassembly
\sailfclRSTNexecute
\subsection{SBCAN}
\sailfclSBCANimmdecodeOneSix
\sailfclSBCANassembly
\sailfclSBCANexecute
\subsection{SBCAR}
\sailfclSBCARrdecode
\sailfclSBCARassembly
\sailfclSBCARexecute
\subsection{SCF}
\sailfclSCFdecode
\sailfclSCFassembly
\sailfclSCFexecute
\subsection{SETNR}
\sailfclSETNRdecodeOneSix
\sailfclSETNRassembly
\sailfclSETNRexecute
\subsection{SLAR}
\sailfclSLARrdecodeOneSix
\sailfclSLARassembly
\sailfclSLARexecute
\subsection{SRAR}
\sailfclSRARrdecodeOneSix
\sailfclSRARassembly
\sailfclSRARexecute
\subsection{SRLR}
\sailfclSRLRrdecodeOneSix
\sailfclSRLRassembly
\sailfclSRLRexecute
\subsection{STOP}
\sailfclSTOPdecodeOneSix
\sailfclSTOPassembly
\sailfclSTOPexecute
\subsection{SUBN}
\sailfclSUBNimmdecodeOneSix
\sailfclSUBNassembly
\sailfclSUBNexecute
\subsection{SUBR}
\sailfclSUBRrdecode
\sailfclSUBRassembly
\sailfclSUBRexecute
\subsection{SWAPR}
\sailfclSWAPRrdecodeOneSix
\sailfclSWAPRassembly
\sailfclSWAPRexecute
\subsection{XORN}
\sailfclXORNimmdecodeOneSix
\sailfclXORNassembly
\sailfclXORNexecute
\subsection{XORR}
\sailfclXORRrdecode
\sailfclXORRassembly
\sailfclXORRexecute


\section{Definitions}

\sailval{decode}
\sailval{decode16}
\sailval{decode24}
\sailval{assembly}
\sailval{execute}
\sailval{timing_tick_cycle}
\sailval{EXTZ}
\sailval{EXTS}
\sailval{truncate}
\sailval{concat_str}

\sailval{reg16_enum_of_num}
\sailval{reg8_enum_of_num}
\sailval{reg8_name}
\sailval{reg16_name}
\sailval{reg8_str}
\sailval{reg16_str}
\sailval{reg16_str_wAF}
\sailval{read_reg8}
\sailval{read_reg16}
\sailval{read_reg16_wAF}
\sailval{write_reg8}
\sailval{write_reg16}
\sailval{write_reg16_wAF}
\sailval{set_PC}
\sailval{set\_PC}
\sailval{condition_true}
\sailval{set_flags}
\sailval{flag_z}
\sailval{flag_n}
\sailval{flag_h}
\sailval{flag_c}
\sailval{make_lsb}

\sailval{read}
\sailval{write}


\section{Support functions}

\sailfn{reg16_enum_of_num}
\sailfn{reg8_enum_of_num}
\sailfn{reg8_name}
\sailfn{reg16_name}
\sailfn{reg8_str}
\sailfn{reg16_str}
\sailfn{reg16_str_wAF}
\sailfn{read_reg8}
\sailfn{read_reg16}
\sailfn{read_reg16_wAF}
\sailfn{write_reg8}
\sailfn{write_reg16}
\sailfn{write_reg16_wAF}
\sailfn{set_PC}
\sailfn{set\_PC}
\sailfn{condition_true}
\sailfn{set_flags}
\sailfn{flag_z}
\sailfn{flag_n}
\sailfn{flag_h}
\sailfn{flag_c}
\sailfn{make_lsb}

\sailfn{read}
\sailfn{write}


\end{document}